<div ng-init="init()" class="padding-top">
    <div class="row">
        <div class="col-lg-8 col-lg-offset-2">
            <form class="form-horizontal">
                <div class="panel-group col-xs-12" id="accordion">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <div class="form-group">
                                <label class="col-xs-4  control-label">
                                    <h3 class="pull-right">Номер заказа:</h3>
                                </label>

                                <div class="col-xs-8">
                                    <label class="control-label"><h3 class="text-primary">{{var.decl.declnumber}}</h3>
                                    </label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-xs-4  control-label">
                                    <h3 class="pull-right">Статус заказа:</h3>
                                </label>

                                <div class="col-xs-8">
                                    <label class="control-label"><h3 class="text-primary">
                                        {{getLast(var.decl.dclresolution).resolutionType.code_name}}</h3></label>
                                </div>
                            </div>
                            <div class="form-group hidden">
                                <div class="col-xs-8">
                                    <input name="orderId" class="form-control" value="{{var.decl.declId}}">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-xs-4 ">
                                    <h3 class=" control-label">Признак предварительности:</h3>
                                </label>

                                <div class="col-xs-7">
                                    <label class=" control-label cursor-pointer" ng-click="changeDecltype()">
                                        <span class="glyphicon glyphicon-remove-circle text-danger" aria-hidden="true"
                                              ng-show="var.decl.decltype"
                                              style="font-size: x-large; margin-top: 18px"></span>
                                        <span class="glyphicon glyphicon-ok-circle text-success" aria-hidden="true"
                                              ng-show="!var.decl.decltype"
                                              style="font-size: x-large; margin-top: 18px"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel panel-default ">
                        <div class="panel-heading ">
                            <div class="row">
                                <h4 class="btn btn-primary mybtn col-xs-3 litle-right"
                                    ng-click="var.showPanel=!var.showPanel">
                                    ЗАКАЗЧИКИ
                                </h4>

                                <div class="col-xs-8">
                                    <div class="col-xs-12 table"
                                         ng-repeat="selectedSubject in var.decl.declarants| filter: filterIdenticalSubject | orderBy: 'declarantId'">
                                        <button class="btn btn-default mybtn litle-right " style="width: 88%"
                                                ng-click="modalSubject(selectedSubject)">
                                            <table class="table-bordered" width="100%">
                                                <td width="30%" ng-if="selectedSubject.declrepr_type == 1">
                                                    заявитель
                                                </td>
                                                <td width="30%" ng-if="selectedSubject.declrepr_type == 2">
                                                    представитель
                                                </td>
                                                <td width="70%">{{selectedSubject.person.surname+"
                                                    "}}{{selectedSubject.person.firstname+"
                                                    "}}{{selectedSubject.person.fullname}}{{selectedSubject.person.unp}}
                                                </td>
                                            </table>
                                        </button>
                                        <button class="btn btn-danger pull-right mybtn btn-block" style="width: 9%"
                                                ng-click="deleteSubject(selectedSubject)">
                                            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-collapse collapse in" ng-show="var.showPanel">
                            <div class="panel-body">
                                <div class="row">
                                    <div class="col-xs-3">
                                        <div class="input-group">
                                            <select ng-model="var.typeSearch"
                                                    ng-options="subjecttype as subjecttype.code_short_name for subjecttype in var.subjecttypes| filterSubjectType"
                                                    class="form-control mySelect">
                                                <option value="" disabled selected>Тип субъекта</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-xs-3">
                                        <input type="text" class="form-control  col-xs-1" placeholder="Личный номер"
                                               ng-model="var.searchSubject.number">
                                    </div>
                                    <div class="col-xs-6">
                                        <div class="input-group">
                                            <input type="text" class="form-control"
                                                   placeholder="ФИО/Наименование организации"
                                                   ng-model="var.searchSubject.fioAndName">
                                                    <span class="input-group-btn">
                                                         <button class="btn btn-default dropdown-toggle" type="submit"
                                                                 ng-click="searchSubjects()">
                                                             Поиск
                                                         </button>
                                                    </span>
                                        </div>
                                    </div>
                                    <div class="col-xs-11 white-background window"
                                         click-anywhere-but-here="var.showSubjectsTable = false"
                                         ng-show="var.showSubjectsTable">
                                        <table class="table table-bordered">
                                            <tr>
                                                <th>Тип</th>
                                                <th>ФИО/Наименование</th>
                                                <th>Дата рождения/регистрации</th>
                                                <th ng-if="var.subjects[0].dtype == 'juridical'">УНП</th>
                                                <th>Регистрационный/Идентификационный номер</th>
                                                <th>Адрес</th>
                                            </tr>
                                            <tr ng-repeat="subject in var.subjects"
                                                class="btn-default cursor-pointer"
                                                ng-click="updateSubjectForm('{{subject}}')">
                                                <td width="5%">{{subject.subjectType.code_short_name}}</td>
                                                <td width="25%">{{subject.surname}}{{" " + subject.firstname}}{{" "
                                                    +
                                                    subject.fathername}}{{" " + subject.fullname}}
                                                </td>
                                                <td width="25%">{{subject.bothRegDate|date}}</td>
                                                <td width="10%" ng-if="subject.dtype == 'juridical'">{{subject.unp}}
                                                </td>
                                                <td width="25%">{{subject.personalNumber}} {{subject.regNumber}}</td>
                                                <td width="25%">{{subject.address}}</td>
                                            </tr>
                                        </table>

                                    </div>
                                    <ul class="nav nav-tabs distance-top padding-top">
                                        <li class="cursor-pointer" role="presentation" ng-click="clientActivate()"
                                            ng-class="var.clientActive">
                                            <a>
                                                Заказчик
                                            </a>
                                        </li>
                                        <li class="cursor-pointer" role="presentation"
                                            ng-click="representativeActivate()" ng-class="var.representativeActive">
                                            <a>
                                                Представитель
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                                <div>
                                    <div class="form-horizontal distance-top" ng-show="var.clientActive == 'active'">
                                        <div class="form-group"
                                             ng-show="'100' <var.typeClient.code_id && var.typeClient.code_id < '500'">
                                            <label class="col-xs-3 control-label">
                                                <span class="pull-right">Тип субъекта:</span>
                                            </label>
                                            <select disabled ng-model="var.typeClient"
                                                    ng-options="subjecttype as subjecttype.code_short_name for subjecttype in var.subjecttypes track by subjecttype.code_id"
                                                    class="form-control col-xs-6 mySelect width310">
                                            </select>
                                        </div>
                                        <div class="form-group"
                                             ng-show="'100' <var.typeClient.code_id && var.typeClient.code_id < '200'">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">
                                                    Фамилия:
                                                </span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled disabled class="form-control"
                                                       ng-model="var.client.firstname">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show="'100' < var.typeClient.code_id && var.typeClient.code_id < '200'">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Имя:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled class="form-control" ng-model="var.client.surname">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show="'100' < var.typeClient.code_id && var.typeClient.code_id < '200'">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Отчество:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled class="form-control" ng-model="var.client.fathername">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show="'100' < var.typeClient.code_id && var.typeClient.code_id < '200'">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Дата рождения:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled class="form-control" type="date"
                                                       ng-model="var.client.bothRegDate">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show="'200' < var.typeClient.code_id && var.typeClient.code_id < '400'">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Сокращенное наименование:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled class="form-control" ng-model="var.client.shortname">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show="'200' < var.typeClient.code_id && var.typeClient.code_id < '400'">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Полное наименование:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled class="form-control" ng-model="var.client.fullname">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show="'100' < var.typeClient.code_id && var.typeClient.code_id < '200'">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Идентификационный номер:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled class="form-control"
                                                       ng-model="var.client.personalNumber">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show="'100' < var.typeClient.code_id && var.typeClient.code_id < '400'">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Адрес:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled class="form-control" ng-model="var.client.address">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show="'200' < var.typeClient.code_id && var.typeClient.code_id < '400'">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Дата регистрации:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled type="date" class="form-control"
                                                       ng-model="var.client.bothRegDate">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show="'200' < var.typeClient.code_id && var.typeClient.code_id < '400'">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">УНП:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled class="form-control" ng-model="var.client.unp">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show="'200' < var.typeClient.code_id && var.typeClient.code_id < '400'">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Регистрационный номер:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled class="form-control" ng-model="var.client.regNumber">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show="'420' == var.typeClient.code_id ">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Административная териториальная еденица (АТЕ):</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <div class="btn-group" ng-class="var.openVar" ng-model="var.ateClient">
                                                    <input disabled class="btn btn-default dropdown-toggle  width310"
                                                           ng-value="var.ateClient"
                                                           ng-click="open()">
                                                    <ul class="dropdown-menu width310">
                                                        <abn-tree tree-data="var.ates"
                                                                  on-select="var.ateClient = branch.id+'-'+branch.label"></abn-tree>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show="'100' < var.typeClient.code_id && var.typeClient.code_id < '500'">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Страна:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <select disabled ng-model="var.client.sitizens"
                                                        ng-options="state as state.code_short_name for state in var.states | orderBy: 'code_short_name' track by state.code_id"
                                                        class="form-control col-xs-6 ">
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div class="col-xs-6 col-xs-offset-3">
                                                <div class="btn btn-primary"
                                                     ng-click="addSubject(var.client.subjectId)">Добавить в заказ
                                                </div>
                                                <div class="btn btn-primary"
                                                     onclick="window.open( '#/subject','_blank')">Добавить или изменить
                                                    субъекта в базе
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-horizontal distance-top"
                                         ng-show="var.representativeActive == 'active'">
                                        <div class="form-group">
                                            <div class="row">
                                                <div class="col-xs-offset-2 col-xs-8 table-bordered">
                                                    <table class="table table-bordered">
                                                        <caption>Выбрать представляемых заявителей</caption>
                                                        <tr ng-repeat="subj in var.decl.declarants| filter: filterSubject"
                                                            class="cursor-pointer btn-default"
                                                            ng-click="selectClient(subj.declarantId)">
                                                            <td width="100%"
                                                                ng-class="{'success': checkChosen(subj.declarantId)}">
                                                                {{subj.person.surname + " " +
                                                                subj.person.firstname + " " + subj.person.fathername + " " + subj.person.fullname}}
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="form-group row"
                                             ng-show="'100' <var.typeClient.code_id && var.typeClient.code_id < '500'">
                                            <label class="col-xs-3 control-label">
                                                <span class="pull-right">Тип субъекта:</span>
                                            </label>
                                            <select disabled ng-model="var.typeRepresent"
                                                    ng-options="subjecttype as subjecttype.code_short_name for subjecttype in var.subjecttypes | filterSubjectType track by subjecttype.code_id"
                                                    class="form-control col-xs-6 mySelect width310">
                                            </select>
                                        </div>
                                        <div class="form-group" ng-model="var.typeRepresent"
                                             ng-show=" 100 < var.typeRepresent.code_id && var.typeRepresent.code_id < 200">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Фамилия:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled class="form-control" ng-model="var.represent.firstname">
                                            </div>
                                        </div>
                                        <div class="form-group" ng-model="var.typeRepresent"
                                             ng-show=" 100 < var.typeRepresent.code_id && var.typeRepresent.code_id < 200">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Имя:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled class="form-control" ng-model="var.represent.surname">
                                            </div>
                                        </div>
                                        <div class="form-group" ng-model="var.typeRepresent"
                                             ng-show=" 100 < var.typeRepresent.code_id && var.typeRepresent.code_id < 200">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Отчество:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled class="form-control"
                                                       ng-model="var.represent.fathername">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show=" 100 < var.typeRepresent.code_id && var.typeRepresent.code_id < 200">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Дата рождения:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled class="form-control" type="date"
                                                       ng-model="var.represent.bothRegDate">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show=" 200 < var.typeRepresent.code_id && var.typeRepresent.code_id < 400">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Сокращенное наименование:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled class="form-control" ng-model="var.represent.shortname">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show=" 100 < var.typeRepresent.code_id && var.typeRepresent.code_id < 200">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Идентификационный номер:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled class="form-control"
                                                       ng-model="var.represent.personalNumber">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show=" 100 < var.typeRepresent.code_id && var.typeRepresent.code_id < 400">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Адрес:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled class="form-control" ng-model="var.represent.address">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show=" 200 < var.typeRepresent.code_id && var.typeRepresent.code_id < 400">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Дата регистрации:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled type="date" class="form-control"
                                                       ng-model="var.represent.bothRegDate">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show=" 200 < var.typeRepresent.code_id && var.typeRepresent.code_id < 400">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">УНП:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled class="form-control" ng-model="var.represent.unp">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show=" 200 < var.typeRepresent.code_id && var.typeRepresent.code_id < 400">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Регистрационный номер:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <input disabled class="form-control" ng-model="var.represent.regnumber">
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show="'420' == var.typeRepresent.code_id ">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Административная териториальная еденица (АТЕ):</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <div class="btn-group" ng-class="var.openVar"
                                                     ng-model="var.ateRepresent">
                                                    <input disabled class="btn btn-default dropdown-toggle  width310"
                                                           ng-value="var.ateRepresent"
                                                           ng-click="open()">
                                                    <ul class="dropdown-menu width310">
                                                        <abn-tree tree-data="var.ates"
                                                                  on-select="var.ateRepresent = branch.id+'-'+branch.label"></abn-tree>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group"
                                             ng-show="100 < var.typeRepresent.code_id && var.typeRepresent.code_id < 500">
                                            <label class="col-xs-3  control-label">
                                                <span class="pull-right">Страна:</span>
                                            </label>

                                            <div class="col-xs-6">
                                                <select disabled ng-model="var.represent.sitizens"
                                                        ng-options="state as state.code_short_name for state in var.states | orderBy: ['code_short_name'] track by state.code_id"
                                                        class="form-control col-xs-6 ">
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div class="col-xs-6 col-xs-offset-3">
                                                <div class="btn btn-primary"
                                                     ng-click="addSubject(var.represent.subjectId)">Добавить в заказ
                                                </div>
                                                <div class="btn btn-primary"
                                                     onclick="window.open( '#/subject','_blank')">Добавить или изменить
                                                    субъекта в базе
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <div class="row">
                                <h4 class="btn btn-primary mybtn col-xs-3 litle-right"
                                    ng-click="var.showPanelOperation =! var.showPanelOperation">
                                    ОПЕРАЦИИ
                                </h4>

                                <div class="col-xs-8">
                                    <div class="col-xs-12 table"
                                         ng-repeat="operation in var.decl.operations| orderBy: 'declarantId'">
                                        <button class="btn btn-default mybtn litle-right " style="width: 88%"
                                                ng-click="modalOperation(operation)">
                                            <table class="table-bordered" width="100%">
                                                <td width="70%">{{operation.operType.code_name+"
                                                    "}}{{operation.operSubtype.code_name+"
                                                    "}}{{operation.regDate| date}}
                                                </td>
                                            </table>
                                        </button>
                                        <button class="btn btn-danger pull-right mybtn btn-block" style="width: 9%"
                                                ng-click="deleteOperation(operation.ooperId)">
                                            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-collapse collapse  in" ng-show="var.showPanelOperation">
                            <div class="panel-body">
                                <div class="form-group">
                                    <label class="col-xs-3  control-label">
                                        <span class="pull-right">Вид операции:</span>
                                    </label>

                                    <div class="col-xs-3">
                                        <select ng-model="operationType"
                                                ng-options="operationType as operationType.code_name for operationType in var.operationType track by operationType.code_id"
                                                class="form-control col-xs-6 ">
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-xs-3  control-label">
                                        <span class="pull-right">Подвид операции:</span>
                                    </label>

                                    <div class="col-xs-3">
                                        <select ng-model="operationSubType"
                                                ng-options="operationType as operationType.code_name for operationType in var.operationSubType track by operationType.code_id"
                                                class="form-control col-xs-6 ">
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-xs-3  control-label">
                                        <span class="pull-right">Основание:</span>
                                    </label>

                                    <div class="col-xs-3">
                                        <select ng-model="operationBase"
                                                ng-options="operationBase as operationBase.code_name for operationBase in var.operationBase track by operationBase.code_id"
                                                class="form-control col-xs-6 ">
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group ">
                                    <div class="panel-default col-xs-offset-1 col-xs-10">
                                        <div class="panel-heading">Ссылки на объекты операции
                                            <button class="pull-right" onclick="window.open('#/object','_blank')"><span
                                                    class="glyphicon glyphicon-plus"></span></button>
                                        </div>
                                        <table class="table table-bordered" title="Ссылки на объекты:">
                                            <tr>
                                                <td>участок</td>
                                                <td>143412341234123</td>
                                                <td>местоположение</td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <button class="btn btn-primary col-xs-offset-3 col-xs-2" ng-click="addOperation()">
                                        Добавить операцию
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel panel-default" ng-init="svar.howPDoc">
                        <div class="panel-heading">
                            <div class="row">
                                <h4 class="btn btn-primary mybtn col-xs-3 litle-right"
                                    ng-click="var.showPDoc=!var.showPDoc">
                                    ДОКУМЕНТЫ
                                </h4>

                                <div class=" col-xs-8  ">
                                    <div class="col-xs-12 table">
                                        <button class="btn btn-default mybtn litle-right " style="width: 88%"
                                                ng-click="modal()">
                                            <table class="table-bordered" width="100%">
                                                <td width="70%">Заявление</td>
                                                <td width="30%">12.12.12</td>
                                            </table>
                                        </button>
                                        <button class="btn btn-danger  pull-right  mybtn   btn-block " style="width: 9%"
                                                ng-click="modal()">
                                            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                        </button>
                                    </div>
                                    <div class="col-xs-12 table">
                                        <button class="btn btn-default mybtn litle-right " style="width: 88%"
                                                ng-click="modal()">
                                            <table class="table-bordered" width="100%">
                                                <td width="70%">Бланк</td>
                                                <td width="30%">12.12.12</td>
                                            </table>
                                        </button>
                                        <button class="btn  btn btn-danger  pull-right  mybtn   btn-block"
                                                style="width: 9%" ng-click="modal()">
                                            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-collapse collapse in" ng-show="var.showPDoc">
                            <div class="panel-body">
                                <div class="form-group">
                                    <label class="col-xs-3 control-label">
                                        Номер документа:
                                    </label>

                                    <div class="col-xs-3 width310">
                                        <input class="form-control">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-xs-3 control-label">
                                        <span class="pull-right">Тип документа:</span>
                                    </label>
                                    <select ng-model="var.typeDoc"
                                            ng-options="doctype as doctype.name for doctype in var.doctypes track by doctype.id"
                                            class="form-control col-xs-6 mySelect width310">
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="col-xs-3  control-label">
                                        <span class="pull-right">Дата:</span>
                                    </label>

                                    <div class="col-xs-3">
                                        <input class="form-control" type="date" ng-model="var.docDate">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-xs-3  control-label">
                                        <span class="pull-right">Описание ораганизации:</span>
                                    </label>

                                    <div class="col-xs-6">
                                        <input class="form-control">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="panel-default col-xs-offset-1 col-xs-10">
                                        <div class="panel-heading">
                                            <h4>
                                                Выбрать операцию заказа
                                            </h4>
                                        </div>
                                        <table class="table table-bordered">
                                            <tr>
                                                <th>дата</th>
                                                <th>вид</th>
                                                <th>основание</th>
                                            </tr>
                                            <tr>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <button class="btn btn-primary col-xs-offset-3  col-xs-2">Сохранить документ
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel panel-default" ng-init="var.status = false">
                        <div class="panel-heading">
                            <div class="row">
                                <div>
                                    <h4 class="btn btn-primary mybtn col-xs-3 litle-right"
                                        ng-click="var.status=!var.status">
                                        ИСТОРИЯ ЗАКАЗА
                                    </h4>
                                </div>
                            </div>
                        </div>
                        <div class="panel-collapse collapse in" ng-show="var.status">
                            <div class="panel-body">
                                <div class="">
                                    <table class="table table-bordered">
                                        <tr>
                                            <th width="20%">
                                                статус
                                            </th>
                                            <th width="15%">
                                                дата
                                            </th>
                                            <th>
                                                пользователь
                                            </th>
                                        </tr>
                                        <tr ng-repeat="resolution in var.decl.dclresolution | orderBy: 'resolutionDate' : true">
                                            <td>
                                                {{resolution.resolutionType.code_name}}
                                            </td>
                                            <td>
                                                {{resolution.resolutionDate| date : "dd.MM.yyyy - HH:mm"}}
                                            </td>
                                            <td>
                                                {{resolution.oPerson.surname + " "}}{{resolution.oPerson.firstname}}
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel-body">
                        <div class="form-group">
                            <label class="col-xs-2  control-label">
                                <span class="pull-right">Примечания:</span>
                            </label>

                            <div class="col-xs-10">
                                <textarea class="form-control" rows="4"></textarea>
                            </div>
                        </div>
                        <div class=distance-top">
                            <div class="form-inline">
                                <button type="button"
                                        class="btn btn-primary col-xs-offset-2 margin-top"
                                        ng-show="getLast(var.decl.dclresolution).resolutionType.code_id == 1"
                                        ng-click="setStatus(2)">
                                    ПРИНЯТЬ
                                </button>
                                <button type="button"
                                        class="btn btn-primary col-xs-offset-2 margin-top"
                                        ng-show="getLast(var.decl.dclresolution).resolutionType.code_id == 2"
                                        ng-click="setStatus(6)">
                                    ПРИОСТАНОВИТЬ
                                </button>
                                <button type="button"
                                        class="btn btn-primary col-xs-offset-2 margin-top"
                                        ng-show="getLast(var.decl.dclresolution).resolutionType.code_id  == 2"
                                        ng-click="setStatus(4)">
                                    ЗАРЕГИСТРИРОВАТЬ
                                </button>
                                <button type="button"
                                        class="btn btn-primary col-xs-offset-2 margin-top"
                                        ng-show="getLast(var.decl.dclresolution).resolutionType.code_id  == 2"
                                        ng-click="setStatus(5)">
                                    ОТКАЗАТЬ В ВЫПОЛНЕНИИ
                                </button>
                                <button type="button"
                                        class="btn btn-primary col-xs-offset-2 margin-top"
                                        ng-show="getLast(var.decl.dclresolution).resolutionType.code_id == 6"
                                        ng-click="setStatus(2)">
                                    ВОЗОБНОВИТЬ
                                </button>
                                <button type="button"
                                        class="btn btn-primary  col-xs-offset-2 margin-top"
                                        ng-show="getLast(var.decl.dclresolution).resolutionType.code_id == 1"
                                        ng-click="setStatus(3)">
                                    ОТКАЗАТЬ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<div class="modal fade" ng-init="showSubject = false" visible="showSubject" ng-class="{'in' : showSubject}"
     ng-style="{true: {display: 'block'}, false: {display: 'none'}}[showSubject]">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dixsiss="modal" aria-hidden="true"
                        ng-click="showSubject = false">&times;</button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-xs-8">
                        <div class="panel-body" style="overflow:auto; height: auto">
                            <table ng-if="var.modalSubjects.person.dtype == 'private'" class="table table-bordered">
                                <tr>
                                    <td>Имя</td>
                                    <td>{{var.modalSubjects.person.firstname}}</td>
                                </tr>
                                <tr>
                                    <td>Фамилия</td>
                                    <td>{{var.modalSubjects.person.fathername}}</td>
                                </tr>
                                <tr>
                                    <td>Отчество</td>
                                    <td>{{var.modalSubjects.person.surname}}</td>
                                </tr>
                                <tr>
                                    <td>Дата</td>
                                    <td>{{var.modalSubjects.person.bothRegDate | date}}</td>
                                </tr>
                                <tr>
                                    <td>Тип</td>
                                    <td>{{var.modalSubjects.person.subjectType.code_name}}</td>
                                </tr>
                                <tr>
                                    <td>Гражданство</td>
                                    <td>{{var.modalSubjects.person.sitizens.code_name}}</td>
                                </tr>
                                <tr>
                                    <td>Личный номер</td>
                                    <td>{{var.modalSubjects.person.personalNumber}}</td>
                                </tr>
                            </table>

                            <table ng-if="var.modalSubjects.person.dtype == 'juridical'" class="table table-bordered">
                                <tr>

                                    <td>Полное наименование</td>
                                    <td>{{var.modalSubjects.person.fullname}}</td>
                                </tr>
                                <tr>
                                    <td>наименование</td>
                                    <td>{{var.modalSubjects.person.shortname}}</td>
                                </tr>
                                <tr>
                                    <td>УНП</td>
                                    <td>{{var.modalSubjects.person.unp}}</td>
                                </tr>
                                <tr>
                                    <td>Рег. номер</td>
                                    <td>{{var.modalSubjects.person.regNumber}}</td>
                                </tr>
                                <tr>
                                    <td>Дата регистрации</td>
                                    <td>{{var.modalSubjects.person.bothRegDate | date}}</td>
                                </tr>
                                <tr>
                                    <td>Орг. структура</td>
                                    <td>{{var.modalSubjects.person.orgRightForm.code_name}}</td>
                                </tr>

                            </table>


                            <table class="table table-bordered" ng-if="var.modalSubjects.declrepr_type == 2">
                                <caption>Представляемые субъекты</caption>
                                <tr ng-repeat="subject in getRelatedSubject(var.modalSubjects)">
                                    <td>
                                        {{subject.parentPerson.person.surname + " " +
                                        subject.parentPerson.person.firstname + " " +
                                        subject.parentPerson.person.fathername + " " + subject.parentPerson.person.fullname}}
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- <modal visible="showSubject" ng-class="{'in' : showSubject}"
       ng-style="{true: {display: 'block'}, false: {display: 'none'}}[showSubject]">
         <div class="row">
             <div class="col-xs-8">
                   <table class="table table-bordered">
                     <tr ng-repeat="(key, subject) in var.modalSubjects.person">
                           <td>{{key}}</td>
                           <td ng-if="!isObject(subject)">{{subject}}</td>
                           <td ng-if="isObject(subject) && key == 'sitizens'">{{subject.code_short_name}}</td>
                           <td ng-if="isObject(subject) && key == 'subjectType'">{{subject.code_short_name}}</td>
                     </tr>
                   </table>
             </div>
         </div>
</modal> -->

<div class="modal fade in " ng-init="showLoading = true" visible="showLoading" ng-class="{'in' : showLoading }"
     ng-style="{true: {display: 'block'}, false: {display: 'none'}}[showLoading ]">
    <div class="center_b">
        <img src="./images/image_836733.gif" alt=""/>
    </div>
</div>

