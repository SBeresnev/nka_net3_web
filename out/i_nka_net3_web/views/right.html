<div class="page-header row" ng-init="init()">

    <h2 class = "col-md-2 col-md-offset-5 text-muted"> ПРАВА </h2>

</div>

<div class="container tabbable " >

    <ul class="nav nav-tabs">

        <li ng-class="getTabClass(1)" ng-click="setActiveTab(1)"> <a ui-sref="search" href="" data-toggle="tab">Поиск</a></li>

        <li ng-class="getTabClass(2)" ng-click="setActiveTab(2)"> <a ui-sref="main" href="" data-toggle="tab" ng-click="initOper()">Редактор</a> </li>

        <li ng-class="getTabClass(3)" ng-click="setActiveTab(3)"> <a ui-sref="collateral" href="" data-toggle="tab">Переход</a></li>

        <li ng-class="getTabClass(4)" ng-click="setActiveTab(4)"> <a ui-sref="rating" href="" data-toggle="tab">Сделки</a></li>

        <li ng-class="getTabClass(5)" ng-click="setActiveTab(5)"> <a ui-sref="rating" href="" data-toggle="tab">Иерархия</a></li>

    </ul>

    <div class="tab-content">

        <!------------------------ Search block ------------------------------------->

          <div id="search" ng-class="getTabPaneClass(1)" >

            <!--***************************************************************************************************************************************************-->

            <div class = "page-header " >

                <div class="btn-group" ng-init="obj_class='btn  btn-default '; sbj_class='btn active btn-danger '">

                    <button type="btn-lg" ng-class="obj_class" ng-click="pr_class = obj_class; obj_class = sbj_class; sbj_class = pr_class">По объекту</button>
                    <button type="btn-lg" ng-class="sbj_class" ng-click="pr_class = obj_class; obj_class = sbj_class; sbj_class = pr_class">По субъекту</button>

                </div>

            </div>

            <div class="input-group input-group-lg">

                <input type="text" class="form-control"  placeholder="Поиск прав" ng-init="sel_subject[tabNum] = ''; sel_object[tabNum] = ''" ng-model="sel_param" disabled />

                <span class="input-group-addon right-span-addon" ><span class="glyphicon glyphicon-zoom-in" ng-click="oSearch()"></span></span>

                <span class="input-group-addon btn" style="background-color:transparent" ng-click = "rightSearch()"> Поиск </span>

            </div>

            <div kendo-grid="mainGrd" class="vert-offset-top-2" ng-hide="rightsDataSearchTabHide" options="mainGridOptions" k-rebind="mainGridOptions.dataSource.data">

                <div k-detail-template>

                    <kendo-tabstrip>

                        <ul>

                            <li class="k-state-active">Правообладатели</li>

                            <li>Объект (детализация)</li>

                        </ul>


                        <div>

                            <div kendo-grid k-options="detailOwnersOptions(dataItem)"></div>

                        </div>

                        <div>

                            <table class="table table-bordered" >

                                <tr><td style="color:navy">Имя объекта:</td><td><b>{{dataItem.bindedObj.object_name}}</b></td></tr>
                                <tr><td style="color:navy">Адрес объекта:</td><td><b>{{dataItem.bindedObj.address}}</b></td></tr>
                                <tr><td style="color:navy">Тип объекта:</td><td><b>{{dataItem.bindedObj.objectType.code_name}}</b></td></tr>
                                <tr><td style="color:navy">Инвентарный номер:</td><td><b>{{dataItem.bindedObj.inventory_number}}</b></td></tr>
                                <tr><td style="color:navy">Кадастровый номер:</td><td><b>{{dataItem.bindedObj.cadastre_number}}</b></td></tr>

                            </table>

                        </div>

                    </kendo-tabstrip>

                </div>

            </div>

            <!--***************************************************************************************************************************************************-->


        </div>

        <!-------------- Main block -------------------------------------------------->

          <div id="main" ng-class="getTabPaneClass(2)"  >

              <!------------- Bufer  ------------->

               <div class = "col-lg-12 vert-offset-top-2">

                 <uib-accordion ng-init="pnl_opn=true">

                  <uib-accordion-group is-open="pnl_opn" panel-class="panel panel-dafault">

                    <uib-accordion-heading>

                        <button class="astext" ng-click="pnl_opn=!pnl_opn"><b>Панель редактирования</b></button> <i ng-click="pnl_opn=!pnl_opn" class="pull-right glyphicon" ng-class="{true:'glyphicon-chevron-down', false: 'glyphicon-chevron-right'}[pnl_opn]"></i>

                    </uib-accordion-heading>

                    <div class="row">

                      <table class="table table-bordered table-hover vert-offset-top-2" ng-show="edit_right.right_id">

                        <thead>

                          <tr>

                             <th>ID</th>

                             <th>Вид права</th>

                             <th>Имя объекта</th>

                             <th>Тип объекта</th>

                             <th>Имя/название правообладателя</th>

                             <th>Доля в праве</th>

                          </tr>

                        <thead>

                        <tbody>

                          <tr ng-repeat="item in edit_right.rightOwners" ng-class="{'right-edit-buffer-tab-select':$index==selected}" ng-click= "OnEditPanelTable($index, item)">

                              <td  width="fit-content">{{item.right_owner_id}}</td>

                              <td  width="fit-content">{{edit_right.right_type_name}}</td>

                              <td  width="fit-content">{{edit_right.bindedObj.object_name}}</td>

                              <td  width="fit-content">{{edit_right.bindedObj.objectType.code_name}}</td>

                              <td  width="fit-content">{{item.owner.surname}}{{" "+item.owner.firstname}}{{" "+item.owner.fathername }}{{item.owner.fullname}}</td>

                              <td  width="fit-content">{{item.numerator_part}}{{item.denominator_part == 1 ?'':'/'+item.denominator_part}}</td>

                          </tr>

                         </tbody>

                       </table>

                        <div class="col-lg-3"></div>

                        <div class="well col-lg-6">

                            <a href="" class="btn btn-success" role="button" ng-click="CreateRight()"><span class="glyphicon glyphicon-flash"></span> <br/>Создать</a>

                            <a href="" class="btn btn-warning" role="button"><span class="glyphicon glyphicon-plus-sign"></span> <br/>Добавить долю</a>

                            <a href="" class="btn btn-warning" role="button"><span class="glyphicon glyphicon-signal"></span> <br/>Изменить</a>

                            <a href="" class="btn btn-warning" role="button" ng-click="LoadBufer()"><span class="glyphicon glyphicon-circle-arrow-down"></span> <br/>Буфер</a>

                            <a href="" class="btn btn-danger" role="button" ng-click="CleanForm()"><span class="glyphicon glyphicon-remove-sign"></span> <br/>Очистить</a>

                        </div>

                    </div>

                </uib-accordion-group>

             </uib-accordion>

           </div>

              <!------------ Right  -------------->

               <div class = "col-lg-6">

                <div class="panel panel-info vert-offset-top-2">

                    <div class="panel-heading fa fa-balance-scale">Право</div>

                    <div class="panel-body ">

                        <div class="form-group vert-offset-top-2">

                            <label class="control-label">Объект:</label>

                            <div class="input-group">

                                <input type="text" class="form-control" placeholder="Объект"  ng-model="form_edit_right.bindedObj.fullname" disabled/>

                                <span class="input-group-addon right-span-addon" ><span class="glyphicon glyphicon-zoom-in" ng-click="objOpen()"></span></span>

                            </div>

                        </div>

                        <div class="form-group">

                            <div class="well">

                                <label class="control-label vert-offset-top-half">Вид права:</label>

                                <select class="form-control" data-live-search="true"  ng-change="setRightType()" ng-model="dict.currgtTyp" ng-options="rgttype.code_short_name for rgttype in dict.rightTypes | orderBy: ['code_short_name'] track by rgttype.code_id" required="required"></select>

                                <label class="control-label vert-offset-top-half">Тип права по числу правообладателей:</label>

                                <select class="form-control" data-live-search="true"  ng-change="setCountType()"  ng-model="dict.currgtCountTyp" ng-options="subtype.code_short_name for subtype in dict.rightFilterCountTypes | orderBy: ['code_short_name'] track by subtype.code_id" required="required"></select>

                                <label class="control-label">Объект операции (сущность)</label>

                                <select class="form-control" data-live-search="true" ng-change="setEntityType()"  ng-model="dict.curentTyp" ng-options="type.code_name group by type.v_prm1 for type in dict.rightFilterEntityTypes | pick:'v_prm1==\'Объект\'|| v_prm1==\'Право\''" required="required"></select>


                            </div>

                        </div>

                        <div class="form-group">

                            <label>Дата действия права:</label>

                            <form class="form-inline" role="form">

                                <div class="form-group">

                                    <label for="ex1">с</label>

                                    <input id="ex1" class="form-control right-edit-date" kendo-date-picker k-format="'yyyy-MM-dd'" k-ng-model="form_edit_right.begin_date"/>

                                </div>

                                <div class="form-group">

                                    <label for="ex2">по</label>

                                    <input id="ex2" class="form-control right-edit-date" kendo-date-picker k-format="'yyyy-MM-dd'"  k-ng-model="form_edit_right.end_date"/>

                                </div>

                            </form>

                        </div>

                        <div class="form-group vert-offset-top-2"  >

                            <uib-accordion ng-init="pnl_opn=true">

                                <uib-accordion-group is-open="pnl_opn" panel-class="panel panel-dafault">

                                    <uib-accordion-heading>

                                        <button class="astext" style="color: maroon"><b>ограничение/обременение прав</b></button>

                                        <blink ng-if="true"> <span class="glyphicon glyphicon-exclamation-sign"></span> </blink>

                                     </uib-accordion-heading>

                                    <div class="row">

                                        <button type="button" class="btn btn-default" ng-click = "getLimitationRight()">Посмотреть</button>

                                        <button type="button" class="btn btn-default" ng-click = "setLimitationRight()">Установить</button>

                                    </div>

                                </uib-accordion-group>

                             </uib-accordion>

                        </div>

                        <div class="checkbox">

                            <label><input type="checkbox" ng-init="form_edit_right.is_needed=0" ng-model="form_edit_right.is_needed"> Признак льготного приобретения </label>

                        </div>

                        <div class="form-group vert-offset-top-2">

                            <label for="comment">Комментарии:</label>

                            <textarea id="comment" class="form-control" rows="4" ng-model="form_edit_right.comments"></textarea>

                        </div>


                    </div>

                </div>

            </div>

              <!--------- RightOwner -------------->

               <div class = "col-lg-6">

                <div class="panel panel-info vert-offset-top-2">

                    <div class="panel-heading fa fa-users">Правообладатели</div>

                    <div class="panel-body">

                        <div class="panel panel-default">

                            <div class="form-group vert-offset-top-2 vert-offset-bottom-2">

                                <label class="control-label">Правообладатель:</label>

                                <div class="input-group">

                                    <input type="text" class="form-control"  placeholder="Субъект" ng-model="form_edit_right.rightOwner.owner.fullname" disabled />

                                    <span class="input-group-addon right-span-addon" ><span class="glyphicon glyphicon-zoom-in" ng-click="sbjOpen()"></span></span>

                                </div>

                            </div>

                            <div class="form-group vert-offset-bottom-2">

                                <uib-accordion ng-init="pnl_opn=true">

                                    <uib-accordion-group  panel-class="panel panel-dafault">

                                           <uib-accordion-heading>  <button class="astext" style="color:maroon" ng-click="parent"><b>Идентификатор права-родителя</b><span class="badge">{{form_edit_right.rightOwner.parent_owner}}</span></button> </uib-accordion-heading>

                                        <div class="row">

                                            <button type="button" class="btn btn-default" ng-click = "getParentOwner()">Посмотреть</button>

                                            <button type="button" class="btn btn-default" ng-click = "setParentOwner()">Установить</button>

                                        </div>

                                    </uib-accordion-group>

                                 </uib-accordion>

                            </div>

                        </div>

                        <div class="form-group vert-offset-top-2 vert-offset-bottom-2">

                            <form class="form-inline" role="form">

                                <div class="form-group">

                                    <label for="fraction">Доля=</label>

                                    <input type="number" class="form-control" placeholder="Числитель" ng-model="form_edit_right.rightOwner.numerator_part">

                                    <img src="images/FS.png" height="40" width="40"/>

                                    <input type="number" class="form-control" id="fraction" placeholder="Знаменатель" ng-model="form_edit_right.rightOwner.denominator_part">

                                </div>

                            </form>

                        </div>

                        <div class="form-group vert-offset-top-2 vert-offset-bottom-2">

                            <div class="col-xs-6">

                                <label for="ex3">Дата возникновения доли:</label>
                                <input id="ex3" class="form-control right-edit-date" kendo-date-picker k-format="'yyyy-MM-dd'" k-ng-model="form_edit_right.rightOwner.date_in" />

                            </div>

                            <div class="col-xs-6">

                                <label for="ex4">Дата прекращения доли:</label>
                                <input id="ex4" class="form-control right-edit-date" kendo-date-picker k-format="'yyyy-MM-dd'" k-ng-model="form_edit_right.rightOwner.date_out" />

                            </div>

                        </div>

                        <div class="form-group vert-offset-top-9 vert-offset-bottom-2">

                            <button class="btn btn-danger col-xs-6" ng-click="dispalyModal('#operModal')">Операции</button>

                        </div>

                    </div>

                </div>

            </div>

        </div>

        <!------------------------ Details block ---------------------------------------->

         <div id="detail" ng-class="getTabPaneClass(3)"> </div>

        <!------------------------ Bargain block ---------------------------------------->

         <div id="bargain" ng-class="getTabPaneClass(4)">Сделки</div>

    </div>

</div>



<!--***********************************************modal block****************************************************************************************************-->

<div ng-include="'views/modright.html'"></div>

<div ng-include="'views/modrightoper.html'"></div>

<div kendo-window="bufwindow" k-visible="false" k-modal="true" k-on-close="CloseBuffer()" k-content="'views/rightbuffer.html'"> </div>

<div kendo-window="sbjwindow" k-visible="false" k-modal="true" k-on-close="csubSearch()" k-content="{url: '{{urlmodSbj}}'}"> </div>

<div kendo-window="objwindow" k-visible="false" k-modal="true" k-on-close="cobjSearch()" k-content="{url: '{{urlmodObj}}'}"> </div>

<div class="modal fade in" ng-init="var.loading = true" ng-style="{true: {display: 'block'}, false: {display: 'none'}}[var.loading ]">
    <div class="center_b">
        <img src="./images/image_836733.gif" alt=""/>
    </div>
</div>

<!--************************************************************************************************************************************************************-->


